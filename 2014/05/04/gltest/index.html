<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>脆皮沙发 - OpenGL渲染混合测试</title>
        <meta name="viewport" content="width=device-width">
        <meta name="description" content="jekhy的游戏开发生涯" />
        <meta name="keywords" content="quick-x,cocos2d-x,game,游戏,手游,mobile,app,php,web,cocos2d,quick,jekhy" />
        <!-- 最新 Bootstrap 核心 CSS 文件 -->
        <link rel="stylesheet" href="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/css/bootstrap.min.css">

        <!-- 可选的Bootstrap主题文件（一般不用引入） -->
        <link rel="stylesheet" href="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/css/bootstrap-theme.min.css">

        <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>

        <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
        <script src="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script>
        
        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/assets/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/assets/css/main.css">
    </head>
    <body>
      
<!-- Fixed navbar -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">

    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">导航开关</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">脆皮沙发</a>
    </div>

    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
        <li class="active"><a href="/">日志</a></li>
        <li ><a href="/about.html">作者</a></li>
      </ul>
    </div>

  </div><!--/.container -->
</div>

      <div class="container">
        <div class="row">
    <div class="col-md-12">

        <ul class="breadcrumb">
            <li><a href="/">日志</a></li>
            
            
            <li><a href="#">游戏开发</a></li>
            
            
            <li class="active">OpenGL渲染混合测试</li>
        </ul>
        <div class="page-header">
            <h1>
                OpenGL渲染混合测试
                 
                <small>一个简单的android工具</small>
                
                <small>[04 May 2014]</small>
            </h1>
            <div>
                
                <span class="label label-info">cocos2d-x</span>
                
                <span class="label label-info">quick-x</span>
                
                <span class="label label-info">openGL</span>
                
            </div>
        </div>
        <p>在<code>quick-x</code>以及<code>cocos2dx</code>中，可使用OpenGL渲染混合模式增强视觉效果，让当前图像在场景中渲染时和重叠的图像按像素分别进行r、g、b、a值的算术运算，以产生色彩、透明度等变化，提升图片叠加显示效果。</p>

<hr>

<h3>需求理解</h3>

<p>一开始美工小伙伴Lyson问我是否能从代码级别支持PS的ADD模式，当时我就一头雾水，对于更喜欢将PS视为“Play Station”的缩写的我来说，PhotoShop简直是个异类！后来大概研究了下，发现了OpenGL的这种混合模式貌似可以做到需求效果，做了一个效果后，小伙伴觉得效果还不错，于是就拿来用了:
<img alt="渲染混合模式效果图" src="/assets/img/gltest.snapshot.png" class="img-thumbnail" /></p>

<h3>代码中使用方式</h3>

<p>使用方式简单，给要做混合模式的sprite（精灵）调用一下setBlendFunc即可：</p>

<div class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="kd">local</span> <span class="n">f</span> <span class="o">=</span> <span class="n">ccBlendFunc</span><span class="p">()</span>
    <span class="n">f</span><span class="p">.</span><span class="n">src</span> <span class="o">=</span> <span class="n">GL_SRC_ALPHA</span>
    <span class="n">f</span><span class="p">.</span><span class="n">dst</span> <span class="o">=</span> <span class="n">GL_ONE_MINUS_SRC_ALPHA</span>
     
    <span class="n">sprite</span><span class="p">:</span><span class="n">setBlendFunc</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></code></pre></div>

<p>其实一开始我没弄明白是否两个要混合的sprite都需要加混合效果，后来尝试了一下发现只需要给其中一个加混合效果即可。</p>

<h3>android效果测试工具</h3>

<p>为了让小伙伴们随时可以做渲染混合效果的测试，刚花了点时间写了个测试工具，目前还是个简单粗暴的版本，只支持android系统（ios没测），并且需要手动将要测试的图片文件copy到<code>/sdcard/gltest/</code>目录下，另外可能还有别的bug以及使用体验方面的不爽，欢迎大家根据真实使用情况随时来喷。</p>

<p><a href="/assets/download/Gltest.apk">点我下载 Gltest.apk</a></p>

<br />
<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=905104"></script>
<!-- UY END -->
    </div>
</div>

      </div>
      <div class="well footer">
    powered by &lt;
    <a href="http://jekyllrb.com/" target="_blank">jekyll</a> +
    <a href="http://www.bootcss.com/" target="_blank">bootstrap</a> +
    <a href="http://github.io/" target="_blank">github</a>
    &gt;
    <small>&copy; Jekhy 2014 </small>
</div>

    </body>
</html>
