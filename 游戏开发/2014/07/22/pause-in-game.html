<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>脆皮沙发 - 在Quick-cocos2d-x中实现动态暂停面板</title>
        <meta name="viewport" content="width=device-width">
        <meta name="description" content="jekhy的游戏开发生涯" />
        <meta name="keywords" content="quick-x,cocos2d-x,game,游戏,手游,mobile,app,php,web,cocos2d,quick,jekhy" />
        <!-- 最新 Bootstrap 核心 CSS 文件 -->
        <link rel="stylesheet" href="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/css/bootstrap.min.css">

        <!-- 可选的Bootstrap主题文件（一般不用引入） -->
        <link rel="stylesheet" href="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/css/bootstrap-theme.min.css">

        <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>

        <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
        <script src="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script>
        
        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="http://diary.jekhy.com/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="http://diary.jekhy.com/css/main.css">
    </head>
    <body>
      
<!-- Fixed navbar -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">

    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">导航开关</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://diary.jekhy.com/">脆皮沙发</a>
    </div>

    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
        <li class="active"><a href="http://diary.jekhy.com/">日志</a></li>
        <li ><a href="http://diary.jekhy.com/about.html">关于</a></li>
      </ul>
    </div>

  </div><!--/.container -->
</div>

      <div class="container">
        <div class="row">
    <div class="col-md-12">

        <ul class="breadcrumb">
            <li><a href="http://diary.jekhy.com/">主页</a></li>
            
            
            <li><a href="#">游戏开发</a></li>
            
            
            <li class="active">在Quick-cocos2d-x中实现动态暂停面板</li>
        </ul>
        <div class="page-header">
            <h1>
                在Quick-cocos2d-x中实现动态暂停面板
                
                <small>[22 Jul 2014]</small>
            </h1>
            <div>
                
                <span class="label label-info">cocos2d-x</span>
                
                <span class="label label-info">quick-x</span>
                
            </div>
        </div>
        <p>之前实现暂停都是临时用<code>CCDirector</code>的<code>pause()</code>和<code>resume()</code>简单实现的，但是想在这个基础上扩展带动画效果的暂停界面就比较困难了，因为<code>pause()</code>方法会将所有运行中的Actions都暂停，也包括新增到场景中的。为了实现像其他游戏一样的“动态暂停面板”，只能换个方式了，今天尝试了下<code>CCDirector</code>的<code>pushScene()</code>的实现方式，代码简洁，并且就是我想要的功能。</p>

<hr>

<h2>CCDirector的 pushScene() 和 popScene()：</h2>

<p>（因为项目还在使用quick 2.x版本，所以类名还是<code>CCDirector</code>，获取单例的方法名为<code>sharedDirector()</code>，它在cocos2d-x 3.x中对应的类名和单例获取方法为<code>Director::getInstance()</code>）
<em>pushScene</em> 是用来将一个新场景作为当前场景，而原来正在显示的场景被压入栈顶，但不会被释放，只是暂停。
<em>popScene</em>  是与pushScene相反的操作，用于将栈顶的场景弹出为当前场景，将当前场景释放。</p>

<p>配合quick-x封装好的<code>display.printscreen</code>截屏功能，完全符合我的需求：</p>

<div class="highlight"><pre><code class="lua"><span class="c1">-- 暂停场景代码</span>
    <span class="kd">local</span> <span class="n">PauseScene</span> <span class="o">=</span> <span class="n">class</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">PauseScene&quot;</span><span class="p">,</span> <span class="k">function</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">display</span><span class="p">.</span><span class="n">newScene</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">PauseScene&quot;</span><span class="p">)</span>
    <span class="k">end</span><span class="p">)</span>

    <span class="k">function</span> <span class="nf">PauseScene</span><span class="p">:</span><span class="n">ctor</span><span class="p">(</span><span class="n">bg</span><span class="p">)</span>
        <span class="n">bg</span><span class="p">:</span><span class="n">center</span><span class="p">():</span><span class="n">addTo</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
        <span class="n">bg</span><span class="p">:</span><span class="n">setColor</span><span class="p">(</span><span class="n">ccc3</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span>
        <span class="kd">local</span> <span class="n">btn</span> <span class="o">=</span> <span class="n">Button</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">Resume&quot;</span><span class="p">)</span>
            <span class="p">:</span><span class="n">center</span><span class="p">()</span>
            <span class="p">:</span><span class="n">addTo</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
            <span class="p">:</span><span class="n">onButtonClicked</span><span class="p">(</span><span class="k">function</span><span class="p">()</span>
                <span class="n">cc</span><span class="p">.</span><span class="n">Director</span><span class="p">:</span><span class="n">sharedDirector</span><span class="p">():</span><span class="n">popScene</span><span class="p">()</span>
            <span class="k">end</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="c1">-- 游戏场景的暂停按钮点击事件</span>
    <span class="n">btn</span><span class="p">:</span><span class="n">onButtonClicked</span><span class="p">(</span><span class="k">function</span><span class="p">()</span>
        <span class="kd">local</span> <span class="n">snapshot</span> <span class="o">=</span> <span class="n">display</span><span class="p">.</span><span class="n">printscreen</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
        <span class="kd">local</span> <span class="n">pScene</span> <span class="o">=</span> <span class="n">PauseScene</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">snapshot</span><span class="p">)</span>
        <span class="n">cc</span><span class="p">.</span><span class="n">Director</span><span class="p">:</span><span class="n">sharedDirector</span><span class="p">():</span><span class="n">pushScene</span><span class="p">(</span><span class="n">pScene</span><span class="p">)</span>
    <span class="k">end</span><span class="p">)</span></code></pre></div>

<p>以前基本都是使用quick中的app:enterScene(&quot;SceneName&quot;)来切换场景，其实也就是调用的<code>CCDirector</code>的<code>replaceScene</code>方法，对于这两个方法还比较陌生，如果用法有什么问题，还请多多指教。</p>

<br />
<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=905104"></script>
<!-- UY END -->
    </div>
</div>

      </div>
      <div class="well footer">
    powered by &lt;
    <a href="http://jekyllrb.com/" target="_blank">jekyll</a> +
    <a href="http://www.bootcss.com/" target="_blank">bootstrap</a> +
    <a href="http://github.io/" target="_blank">github</a>
    &gt;
    <small>&copy; Jekhy 2014 </small>
</div>

    </body>
</html>
